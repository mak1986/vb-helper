<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Viabill Integration Example</title>
</head>

<body>
  <h1>Viabill Integration</h1>
  <p>The hidden price containers and Viabill script will be injected before &lt;/body&gt;</p>

  <!-- Core (required) -->
  <script src="dist/core/vb-helper.min.es2015.js"></script>

  <!-- Consent adapter (optional, Shopify) -->
  <script src="dist/consent-adapters/shopify-consent-adapter.min.es2015.js"></script>

  <script>

    document.addEventListener("DOMContentLoaded", function () {

      const code = "hBLuQRwF0AY%3D";
      const extraWidth = 20;
      const pricetagConfigs = [
        {
          type: "product",
          priceContainerSelector: ".product__info-wrapper .product__tax",
          primaryPriceSelector: ".product__info-wrapper .price .price-item--regular",
          secondaryPriceSelector: ".product__info-wrapper .price .price-item--sale",
          style: "display:flex;justify-content:flex-start;"
        },
        {
          type: "basket",
          priceContainerSelector: ".cart__footer .totals",
          primaryPriceSelector: ".cart__footer .totals .totals__total-value",
          style: "display:flex;justify-content:flex-end;margin-top:10px;"
        },
        {
          type: "mini-basket",
          priceContainerSelector: ".cart-drawer__footer",
          primaryPriceSelector: ".cart-drawer__footer .totals__total-value",
          style: "display:flex;justify-content:center;padding-bottom:10px;"
        }
      ];

      function waitForVBHelper() {
        if (window.vbHelper?.init) {
          // âœ… Explicit (non-DX): bind Shopify consent BEFORE init loads ViaBill script
          // (only if your adapter exposes this function)
          if (window.vbHelper.bindShopifyConsent) {
            window.vbHelper.bindShopifyConsent({ mode: "categories", debug: true });
          }

          window.vbHelper.init({
            code,
            extraWidth,
            pricetagConfigs
          });
        } else {
          setTimeout(waitForVBHelper, 50);
        }
      }

      waitForVBHelper();
    });
  </script>
</body>

</html>